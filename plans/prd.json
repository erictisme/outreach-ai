{
  "project": "outreach-v2",
  "description": "Split Step 2 for better regeneration flow",
  "features": [
    {
      "id": "F55",
      "name": "Split Step 2 into 2a (Context Info) and 2b (Segments)",
      "priority": 55,
      "passes": true,
      "description": "Separate context info from segments so changes trigger proper regeneration",
      "steps": [
        "Step 2a: Context Info - Client Name, Product, Value Proposition, Target Market, Target Seniority, Target Roles",
        "Step 2b: Segments - Target Segments with add/edit/delete",
        "In WizardPanel.tsx: Update step list to show 2a and 2b (or just show as sub-steps)",
        "Option A: Make them separate accordion sections (Setup, Context, Segments, Companies...)",
        "Option B: Keep as one step but with clear 'Save & Continue to Segments' button",
        "Ensure Step 3 (Companies) knows when to regenerate based on context/segment changes"
      ],
      "acceptance": "Step 2 split allows saving context before editing segments"
    },
    {
      "id": "F56",
      "name": "Track context changes for Step 3 regeneration",
      "priority": 56,
      "passes": true,
      "description": "When context or segments change, Step 3 should prompt to regenerate companies",
      "steps": [
        "Store lastGeneratedAt timestamp when companies generated",
        "Store contextHash or contextUpdatedAt when Step 2 info saved",
        "In CompaniesStep: Compare timestamps",
        "If context changed after last generation, show warning: 'Context has changed. Regenerate companies?'",
        "Add 'Regenerate Companies' button that clears old and generates new",
        "Keep 'Keep Existing' option for user who wants to keep current companies"
      ],
      "acceptance": "Step 3 detects context changes and prompts for regeneration"
    },
    {
      "id": "F57",
      "name": "ContextStep.tsx - Save context info separately",
      "priority": 57,
      "passes": true,
      "description": "Context step saves basic info with explicit Save button",
      "steps": [
        "ContextStep shows: Client Name, Product, Value Proposition, Target Market, Target Seniority, Target Roles",
        "'Save Context' button saves to project.schema_config",
        "Update project.schema_config.contextUpdatedAt timestamp on save",
        "Show 'Saved!' confirmation",
        "After saving, either auto-advance to Segments or show 'Continue to Segments' button",
        "Remove segments editing from this component"
      ],
      "acceptance": "Context info saves separately with timestamp"
    },
    {
      "id": "F58",
      "name": "New SegmentsStep.tsx component",
      "priority": 58,
      "passes": true,
      "description": "Dedicated step for managing target segments",
      "steps": [
        "Create src/components/wizard/SegmentsStep.tsx",
        "Display existing segments as cards/list",
        "Add segment: name, description, example companies",
        "Edit segment inline",
        "Delete segment with confirmation",
        "'Save Segments' button updates project.schema_config.segments",
        "Update segmentsUpdatedAt timestamp",
        "'Continue to Companies' button advances to Step 3"
      ],
      "acceptance": "Segments have dedicated editing step"
    },
    {
      "id": "F59",
      "name": "Update WizardPanel with new step structure",
      "priority": 59,
      "passes": false,
      "description": "WizardPanel shows 6 steps: Setup, Context, Segments, Companies, Contacts, Emails",
      "steps": [
        "In WizardPanel.tsx: Update STEPS array to include Segments step",
        "Step order: 1-Setup, 2-Context, 3-Segments, 4-Companies, 5-Contacts, 6-Emails",
        "Import and render SegmentsStep component",
        "Update step navigation logic",
        "Update completion indicators",
        "Update URL ?step param handling for new step count"
      ],
      "acceptance": "Wizard shows 6 steps with Segments as step 3"
    },
    {
      "id": "F60",
      "name": "Final verification - step split",
      "priority": 60,
      "passes": false,
      "description": "Test the new step flow",
      "steps": [
        "pnpm build passes",
        "Step 1 (Setup): Enter context, extract",
        "Step 2 (Context): Edit/save context info",
        "Step 3 (Segments): Edit/save segments",
        "Step 4 (Companies): See regeneration warning if context changed",
        "Step 5 (Contacts): Find contacts",
        "Step 6 (Emails): Generate emails",
        "Back button works correctly between all steps"
      ],
      "acceptance": "6-step flow works with proper regeneration prompts"
    }
  ]
}
